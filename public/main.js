'use strict';

var angApp = angular.module('main', ['ui.router']);

angApp.config(function ($urlRouterProvider) {
  $urlRouterProvider.otherwise('/');
});

angApp.config(function ($stateProvider) {
  $stateProvider.state('dashboardState', {
    url: '/',
    templateUrl: './app/dashboard/dashboard.html',
    controller: 'DashboardCtrl',
    resolve: {
      initialize: function initialize(Storage) {
        return Storage.init();
      }
    }
  });
});

angApp.controller('DashboardCtrl', function ($rootScope, $scope, Storage, initialize) {
  //code
  $rootScope.$on('dbLoaded', function () {
    console.log('initialized', Storage.findOrCreate('Rick and Morty').then(function (result) {
      return console.log(result);
    }));
    // .then(function(result) {console.log(result)});
  });
});

app.config(function ($stateProvider) {
  $stateProvider.state('dashboardState', {
    url: '/test',
    templateUrl: './app/js/dashboard/dashboard.html'
  });
});

angApp.controller('ExplorerCtrl', function ($scope, $element, vidConstants) {
  // Code to make the 'file holder div' take in
  // file path names
  var homedir = process.platform === 'win32' ? process.env.HOMEPATH : process.env.HOME;
  var shell = require('electron').shell;
  // var finder = require('./server/algorithms/search.js')
  var fs = require('fs');
  var path = require('path');
  var find = require('findit');
  var parseVideo = require('video-name-parser');

  //Button called "browse", opens homedirectory of user
  $scope.openHome = function () {
    return shell.showItemInFolder(homedir);
  };

  // --------------------------
  // Code that allows you to recurse through the directories
  //provided and return file names that end with certain exts

  var holder = document.getElementById('fileholder');
  holder.ondragover = function () {
    this.className = 'hover';
    return false;
  };
  holder.ondragleave = function () {
    this.className = '';
    return false;
  };
  holder.ondrop = function (e) {
    var dataPathArray = [];
    var soln = [];
    e.preventDefault();
    for (var i = 0; i < e.dataTransfer.files.length; ++i) {
      dataPathArray.push(e.dataTransfer.files[i].path);
    }
    dataPathArray.forEach(function (data) {
      var finder = find(data);
      finder.on('file', function (file, stat) {
        if (vidConstants.vidExtensions.indexOf(path.extname(file)) !== -1) {
          var parsed = parseVideo(file);
          soln.push(parsed);
        }
        console.log("Thank you for your patience!");
      });
      finder.on('end', function (file, stat) {
        // soln.forEach()
        console.log('soln', soln);
      });
    });
    return false;
  };
});

angApp.factory('vidConstants', function () {
  return {
    vidExtensions: ['.mkv', '.avi', '.mov', '.gifv', '.flv']
  };
});

angApp.config(function ($stateProvider) {
  $stateProvider.state('explorerState', {
    url: '/',
    templateUrl: './app/js/explorer/explorer.html',
    controller: 'ExplorerCtrl'
  });
});

'use strict';
var loki = require('lokijs'),
    path = require('path'),
    Promise = require('bluebird'),
    omdb = Promise.promisifyAll(require('omdb'));

angApp.factory('Storage', function ($rootScope) {
  function findOmdb(name) {
    console.log('in omdb function', name);
    return omdb.searchAsync(name).then(function (results) {
      if (results.length < 1) return;
      if (results.length >= 1) {
        return omdb.getAsync(results[0].imdb);
      }
    });
  };
  function addMedia(mediaTitle) {
    var self = this;
    console.log(self);
    return new Promise(function (resolve, reject) {
      console.log(self);
      findOmdb(mediaTitle).then(function (metadata) {
        var media = {};
        media = metadata;
        media._id = metadata.imdb.id;
        self.collection.insert(media);
        console.log(media);
        self.db.saveDatabase();
      }).then(function () {
        resolve(self);
      }, function (err) {
        reject(err);
      });
    });
  };

  return {
    db: new loki(path.resolve(__dirname, 'app.db')),
    collection: null,
    loaded: false,
    init: function init() {
      var self = this;
      self.db.loadDatabase({}, function () {
        return new Promise(function (resolve, reject) {
          if (self.db.collections.length) {
            self.collection = self.db.getCollection('media');
            self.loaded = true;
            return resolve(self);
          } else {
            self.db.addCollection('media');
            self.db.saveDatabase();
            self.collection = self.db.getCollection('media');
            self.loaded = true;
            return resolve(self);
          }
        }).then(function () {
          console.log('in the factory', self);
          $rootScope.$emit('dbLoaded');
        }).then(null, function (err) {
          console.log(err);
        });
        // .catch(function(err) {
        // 	console.log(err);
        // })
      });
    },
    findMedia: function findMedia(mediaId) {
      var self = this;
      return new Promise(function (resolve, reject) {
        if (self.loaded && self.db.getCollection('media')) {
          return resolve(self.collection.find({ "_id": mediaId }));
        } else {
          reject(new Error('db is not ready'));
        }
      });
    },
    addMedia: addMedia,
    findOrCreate: function findOrCreate(mediaTitle) {
      var self = this;
      console.log('in the findOrCreate');
      return new Promise(function (resolve, reject) {
        if (self.loaded && self.db.getCollection('media')) {
          findOmdb(mediaTitle).then(function (metadata) {
            if (self.collection.find({ '_id': metadata.imdb.id }).length > 0) {
              console.log(self.collection.find({ 'title': mediaTitle }).length);
              return resolve(null);
            } else {
              console.log('creating');
              var media = {};
              media = metadata;
              media._id = metadata.imdb.id;
              self.collection.insert(media);
              console.log(media);
              self.db.saveDatabase();
              resolve(self);
            }
          });
        } else {
          reject(new Error('db is not ready'));
        }
      });
    }
  };
});

app.controller('SidebarCtrl', function ($scope) {

  //Leftover attempts to make sidebar toggleable
  // $scope.menuActive = false;
  // var wrapper = document.getElementById('sidebar-wrapper')
  // $scope.toggleMenu = function(e) {
  //   // wrapper.toggleClass("toggled");
  //   $scope.menuActive = !$scope.menuActive;
  //}

  //placeholder for making new playlists

});

app.directive('sidebar', function () {
  return {
    restrict: 'E',
    templateUrl: './app/js/directives/sidebar/sidebar.html'
  };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImRhc2hib2FyZC9kYXNoYm9hcmQuc3RhdGUuanMiLCJqcy9kYXNoYm9hcmQvZGFzaGJvYXJkLmNvbnRyb2xsZXIuanMiLCJqcy9kYXNoYm9hcmQvZGFzaGJvYXJkLnN0YXRlLmpzIiwianMvZXhwbG9yZXIvZXhwbG9yZXIuY29udHJvbGxlci5qcyIsImpzL2V4cGxvcmVyL2V4cGxvcmVyLnN0YXRlLmpzIiwianMvY29tbW9uL2ZhY3Rvcmllcy9DYWNoZUZhY3RvcnkuanMiLCJqcy9kaXJlY3RpdmVzL3NpZGViYXIvc2lkZWJhci5jb250cm9sbGVyLmpzIiwianMvZGlyZWN0aXZlcy9zaWRlYmFyL3NpZGViYXIuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQSxNQUFBLEdBQUEsT0FBQSxDQUFBLE1BQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQSxDQUFBOztBQUVBLE1BQUEsQ0FBQSxNQUFBLENBQUEsVUFBQSxrQkFBQSxFQUFBO0FBQ0Esb0JBQUEsQ0FBQSxTQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7Q0FDQSxDQUFBLENBQUE7O0FDSkEsTUFBQSxDQUFBLE1BQUEsQ0FBQSxVQUFBLGNBQUEsRUFBQTtBQUNBLGdCQUFBLENBQUEsS0FBQSxDQUFBLGdCQUFBLEVBQUE7QUFDQSxPQUFBLEVBQUEsR0FBQTtBQUNBLGVBQUEsRUFBQSxnQ0FBQTtBQUNBLGNBQUEsRUFBQSxlQUFBO0FBQ0EsV0FBQSxFQUFBO0FBQ0EsZ0JBQUEsRUFBQSxvQkFBQSxPQUFBLEVBQUE7QUFDQSxlQUFBLE9BQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtPQUNBO0tBQ0E7R0FDQSxDQUFBLENBQUE7Q0FDQSxDQUFBLENBQUE7O0FDWEEsTUFBQSxDQUFBLFVBQUEsQ0FBQSxlQUFBLEVBQUEsVUFBQSxVQUFBLEVBQUEsTUFBQSxFQUFBLE9BQUEsRUFBQSxVQUFBLEVBQUE7O0FBRUEsWUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLEVBQUEsWUFBQTtBQUNBLFdBQUEsQ0FBQSxHQUFBLENBQUEsYUFBQSxFQUFBLE9BQUEsQ0FBQSxZQUFBLENBQUEsZ0JBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLE1BQUE7YUFBQSxPQUFBLENBQUEsR0FBQSxDQUFBLE1BQUEsQ0FBQTtLQUFBLENBQUEsQ0FBQSxDQUFBOztHQUVBLENBQUEsQ0FBQTtDQUVBLENBQUEsQ0FBQTs7QUNQQSxHQUFBLENBQUEsTUFBQSxDQUFBLFVBQUEsY0FBQSxFQUFBO0FBQ0EsZ0JBQUEsQ0FBQSxLQUFBLENBQUEsZ0JBQUEsRUFBQTtBQUNBLE9BQUEsRUFBQSxPQUFBO0FBQ0EsZUFBQSxFQUFBLG1DQUFBO0dBQ0EsQ0FBQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBOztBQ0xBLE1BQUEsQ0FBQSxVQUFBLENBQUEsY0FBQSxFQUFBLFVBQUEsTUFBQSxFQUFBLFFBQUEsRUFBQSxZQUFBLEVBQUE7OztBQUdBLE1BQUEsT0FBQSxHQUFBLE9BQUEsQ0FBQSxRQUFBLEtBQUEsT0FBQSxHQUFBLE9BQUEsQ0FBQSxHQUFBLENBQUEsUUFBQSxHQUNBLE9BQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxDQUFBO0FBQ0EsTUFBQSxLQUFBLEdBQUEsT0FBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQTs7QUFFQSxNQUFBLEVBQUEsR0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7QUFDQSxNQUFBLElBQUEsR0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7QUFDQSxNQUFBLElBQUEsR0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7QUFDQSxNQUFBLFVBQUEsR0FBQSxPQUFBLENBQUEsbUJBQUEsQ0FBQSxDQUFBOzs7QUFHQSxRQUFBLENBQUEsUUFBQSxHQUFBLFlBQUE7QUFDQSxXQUFBLEtBQUEsQ0FBQSxnQkFBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBO0dBQ0EsQ0FBQTs7Ozs7O0FBTUEsTUFBQSxNQUFBLEdBQUEsUUFBQSxDQUFBLGNBQUEsQ0FBQSxZQUFBLENBQUEsQ0FBQTtBQUNBLFFBQUEsQ0FBQSxVQUFBLEdBQUEsWUFBQTtBQUNBLFFBQUEsQ0FBQSxTQUFBLEdBQUEsT0FBQSxDQUFBO0FBQ0EsV0FBQSxLQUFBLENBQUE7R0FDQSxDQUFBO0FBQ0EsUUFBQSxDQUFBLFdBQUEsR0FBQSxZQUFBO0FBQ0EsUUFBQSxDQUFBLFNBQUEsR0FBQSxFQUFBLENBQUE7QUFDQSxXQUFBLEtBQUEsQ0FBQTtHQUNBLENBQUE7QUFDQSxRQUFBLENBQUEsTUFBQSxHQUFBLFVBQUEsQ0FBQSxFQUFBO0FBQ0EsUUFBQSxhQUFBLEdBQUEsRUFBQSxDQUFBO0FBQ0EsUUFBQSxJQUFBLEdBQUEsRUFBQSxDQUFBO0FBQ0EsS0FBQSxDQUFBLGNBQUEsRUFBQSxDQUFBO0FBQ0EsU0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxZQUFBLENBQUEsS0FBQSxDQUFBLE1BQUEsRUFBQSxFQUFBLENBQUEsRUFBQTtBQUNBLG1CQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxZQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO0tBQ0E7QUFDQSxpQkFBQSxDQUFBLE9BQUEsQ0FBQSxVQUFBLElBQUEsRUFBQTtBQUNBLFVBQUEsTUFBQSxHQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtBQUNBLFlBQUEsQ0FBQSxFQUFBLENBQUEsTUFBQSxFQUFBLFVBQUEsSUFBQSxFQUFBLElBQUEsRUFBQTtBQUNBLFlBQUEsWUFBQSxDQUFBLGFBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxLQUNBLENBQUEsQ0FBQSxFQUFBO0FBQ0EsY0FBQSxNQUFBLEdBQUEsVUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO0FBQ0EsY0FBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQTtTQUNBO0FBQ0EsZUFBQSxDQUFBLEdBQUEsQ0FBQSw4QkFBQSxDQUFBLENBQUE7T0FDQSxDQUFBLENBQUE7QUFDQSxZQUFBLENBQUEsRUFBQSxDQUFBLEtBQUEsRUFBQSxVQUFBLElBQUEsRUFBQSxJQUFBLEVBQUE7O0FBRUEsZUFBQSxDQUFBLEdBQUEsQ0FBQSxNQUFBLEVBQUEsSUFBQSxDQUFBLENBQUE7T0FDQSxDQUFBLENBQUE7S0FDQSxDQUFBLENBQUE7QUFDQSxXQUFBLEtBQUEsQ0FBQTtHQUNBLENBQUE7Q0FDQSxDQUFBLENBQUE7O0FBR0EsTUFBQSxDQUFBLE9BQUEsQ0FBQSxjQUFBLEVBQUEsWUFBQTtBQUNBLFNBQUE7QUFDQSxpQkFBQSxFQUFBLENBQUEsTUFBQSxFQUFBLE1BQUEsRUFBQSxNQUFBLEVBQUEsT0FBQSxFQUFBLE1BQUEsQ0FBQTtHQUNBLENBQUE7Q0FDQSxDQUFBLENBQUE7O0FDN0RBLE1BQUEsQ0FBQSxNQUFBLENBQUEsVUFBQSxjQUFBLEVBQUE7QUFDQSxnQkFBQSxDQUFBLEtBQUEsQ0FBQSxlQUFBLEVBQUE7QUFDQSxPQUFBLEVBQUEsR0FBQTtBQUNBLGVBQUEsRUFBQSxpQ0FBQTtBQUNBLGNBQUEsRUFBQSxjQUFBO0dBQ0EsQ0FBQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBOztBQ05BLFlBQUEsQ0FBQTtBQUNBLElBQUEsSUFBQSxHQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUE7SUFDQSxJQUFBLEdBQUEsT0FBQSxDQUFBLE1BQUEsQ0FBQTtJQUNBLE9BQUEsR0FBQSxPQUFBLENBQUEsVUFBQSxDQUFBO0lBQ0EsSUFBQSxHQUFBLE9BQUEsQ0FBQSxZQUFBLENBQUEsT0FBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLENBQUE7O0FBR0EsTUFBQSxDQUFBLE9BQUEsQ0FBQSxTQUFBLEVBQUEsVUFBQSxVQUFBLEVBQUE7QUFDQSxXQUFBLFFBQUEsQ0FBQSxJQUFBLEVBQUE7QUFDQSxXQUFBLENBQUEsR0FBQSxDQUFBLGtCQUFBLEVBQUEsSUFBQSxDQUFBLENBQUE7QUFDQSxXQUFBLElBQUEsQ0FBQSxXQUFBLENBQUEsSUFBQSxDQUFBLENBQ0EsSUFBQSxDQUFBLFVBQUEsT0FBQSxFQUFBO0FBQ0EsVUFBQSxPQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsRUFBQSxPQUFBO0FBQ0EsVUFBQSxPQUFBLENBQUEsTUFBQSxJQUFBLENBQUEsRUFBQTtBQUNBLGVBQUEsSUFBQSxDQUFBLFFBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7T0FDQTtLQUNBLENBQUEsQ0FBQTtHQUNBLENBQUE7QUFDQSxXQUFBLFFBQUEsQ0FBQSxVQUFBLEVBQUE7QUFDQSxRQUFBLElBQUEsR0FBQSxJQUFBLENBQUE7QUFDQSxXQUFBLENBQUEsR0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO0FBQ0EsV0FBQSxJQUFBLE9BQUEsQ0FBQSxVQUFBLE9BQUEsRUFBQSxNQUFBLEVBQUE7QUFDQSxhQUFBLENBQUEsR0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO0FBQ0EsY0FBQSxDQUFBLFVBQUEsQ0FBQSxDQUNBLElBQUEsQ0FBQSxVQUFBLFFBQUEsRUFBQTtBQUNBLFlBQUEsS0FBQSxHQUFBLEVBQUEsQ0FBQTtBQUNBLGFBQUEsR0FBQSxRQUFBLENBQUE7QUFDQSxhQUFBLENBQUEsR0FBQSxHQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLFVBQUEsQ0FBQSxNQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7QUFDQSxlQUFBLENBQUEsR0FBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLEVBQUEsQ0FBQSxZQUFBLEVBQUEsQ0FBQTtPQUNBLENBQUEsQ0FDQSxJQUFBLENBQUEsWUFBQTtBQUNBLGVBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtPQUNBLEVBQUEsVUFBQSxHQUFBLEVBQUE7QUFDQSxjQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7T0FDQSxDQUFBLENBQUE7S0FDQSxDQUFBLENBQUE7R0FDQSxDQUFBOztBQUVBLFNBQUE7QUFDQSxNQUFBLEVBQUEsSUFBQSxJQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxTQUFBLEVBQUEsUUFBQSxDQUFBLENBQUE7QUFDQSxjQUFBLEVBQUEsSUFBQTtBQUNBLFVBQUEsRUFBQSxLQUFBO0FBQ0EsUUFBQSxFQUFBLGdCQUFBO0FBQ0EsVUFBQSxJQUFBLEdBQUEsSUFBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLEVBQUEsQ0FBQSxZQUFBLENBQUEsRUFBQSxFQUFBLFlBQUE7QUFDQSxlQUFBLElBQUEsT0FBQSxDQUFBLFVBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQTtBQUNBLGNBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxXQUFBLENBQUEsTUFBQSxFQUFBO0FBQ0EsZ0JBQUEsQ0FBQSxVQUFBLEdBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxhQUFBLENBQUEsT0FBQSxDQUFBLENBQUE7QUFDQSxnQkFBQSxDQUFBLE1BQUEsR0FBQSxJQUFBLENBQUE7QUFDQSxtQkFBQSxPQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7V0FDQSxNQUFBO0FBQ0EsZ0JBQUEsQ0FBQSxFQUFBLENBQUEsYUFBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBO0FBQ0EsZ0JBQUEsQ0FBQSxFQUFBLENBQUEsWUFBQSxFQUFBLENBQUE7QUFDQSxnQkFBQSxDQUFBLFVBQUEsR0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLGFBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTtBQUNBLGdCQUFBLENBQUEsTUFBQSxHQUFBLElBQUEsQ0FBQTtBQUNBLG1CQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtXQUNBO1NBQ0EsQ0FBQSxDQUNBLElBQUEsQ0FBQSxZQUFBO0FBQ0EsaUJBQUEsQ0FBQSxHQUFBLENBQUEsZ0JBQUEsRUFBQSxJQUFBLENBQUEsQ0FBQTtBQUNBLG9CQUFBLENBQUEsS0FBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBO1NBQ0EsQ0FBQSxDQUNBLElBQUEsQ0FBQSxJQUFBLEVBQUEsVUFBQSxHQUFBLEVBQUE7QUFDQSxpQkFBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTtTQUNBLENBQUEsQ0FBQTs7OztPQUlBLENBQUEsQ0FBQTtLQUNBO0FBQ0EsYUFBQSxFQUFBLG1CQUFBLE9BQUEsRUFBQTtBQUNBLFVBQUEsSUFBQSxHQUFBLElBQUEsQ0FBQTtBQUNBLGFBQUEsSUFBQSxPQUFBLENBQUEsVUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBO0FBQ0EsWUFBQSxJQUFBLENBQUEsTUFBQSxJQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsYUFBQSxDQUFBLE9BQUEsQ0FBQSxFQUFBO0FBQ0EsaUJBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsS0FBQSxFQUFBLE9BQUEsRUFBQSxDQUFBLENBQUEsQ0FBQTtTQUNBLE1BQUE7QUFDQSxnQkFBQSxDQUFBLElBQUEsS0FBQSxDQUFBLGlCQUFBLENBQUEsQ0FBQSxDQUFBO1NBQ0E7T0FDQSxDQUFBLENBQUE7S0FDQTtBQUNBLFlBQUEsRUFBQSxRQUFBO0FBQ0EsZ0JBQUEsRUFBQSxzQkFBQSxVQUFBLEVBQUE7QUFDQSxVQUFBLElBQUEsR0FBQSxJQUFBLENBQUE7QUFDQSxhQUFBLENBQUEsR0FBQSxDQUFBLHFCQUFBLENBQUEsQ0FBQTtBQUNBLGFBQUEsSUFBQSxPQUFBLENBQUEsVUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBO0FBQ0EsWUFBQSxJQUFBLENBQUEsTUFBQSxJQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsYUFBQSxDQUFBLE9BQUEsQ0FBQSxFQUFBO0FBQ0Esa0JBQUEsQ0FBQSxVQUFBLENBQUEsQ0FDQSxJQUFBLENBQUEsVUFBQSxRQUFBLEVBQUE7QUFDQSxnQkFBQSxJQUFBLENBQUEsVUFBQSxDQUFBLElBQUEsQ0FBQSxFQUFBLEtBQUEsRUFBQSxRQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsRUFBQSxDQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsRUFBQTtBQUNBLHFCQUFBLENBQUEsR0FBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsT0FBQSxFQUFBLFVBQUEsRUFBQSxDQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7QUFDQSxxQkFBQSxPQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7YUFDQSxNQUFBO0FBQ0EscUJBQUEsQ0FBQSxHQUFBLENBQUEsVUFBQSxDQUFBLENBQUE7QUFDQSxrQkFBQSxLQUFBLEdBQUEsRUFBQSxDQUFBO0FBQ0EsbUJBQUEsR0FBQSxRQUFBLENBQUE7QUFDQSxtQkFBQSxDQUFBLEdBQUEsR0FBQSxRQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQTtBQUNBLGtCQUFBLENBQUEsVUFBQSxDQUFBLE1BQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQTtBQUNBLHFCQUFBLENBQUEsR0FBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO0FBQ0Esa0JBQUEsQ0FBQSxFQUFBLENBQUEsWUFBQSxFQUFBLENBQUE7QUFDQSxxQkFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO2FBQ0E7V0FDQSxDQUFBLENBQUE7U0FDQSxNQUFBO0FBQ0EsZ0JBQUEsQ0FBQSxJQUFBLEtBQUEsQ0FBQSxpQkFBQSxDQUFBLENBQUEsQ0FBQTtTQUNBO09BQ0EsQ0FBQSxDQUFBO0tBQ0E7R0FDQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBOztBQzlHQSxHQUFBLENBQUEsVUFBQSxDQUFBLGFBQUEsRUFBQSxVQUFBLE1BQUEsRUFBQTs7Ozs7Ozs7Ozs7O0NBYUEsQ0FBQSxDQUFBOztBQ2JBLEdBQUEsQ0FBQSxTQUFBLENBQUEsU0FBQSxFQUFBLFlBQUE7QUFDQSxTQUFBO0FBQ0EsWUFBQSxFQUFBLEdBQUE7QUFDQSxlQUFBLEVBQUEsMENBQUE7R0FDQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYW5nQXBwID0gYW5ndWxhci5tb2R1bGUoJ21haW4nLCBbJ3VpLnJvdXRlciddKTtcblxuYW5nQXBwLmNvbmZpZyhmdW5jdGlvbigkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xufSlcbiIsImFuZ0FwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xuICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnZGFzaGJvYXJkU3RhdGUnLCB7XG4gICAgdXJsOiAnLycsXG4gICAgdGVtcGxhdGVVcmw6ICcuL2FwcC9kYXNoYm9hcmQvZGFzaGJvYXJkLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsJyxcbiAgICByZXNvbHZlOiB7XG4gICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihTdG9yYWdlKSB7XG4gICAgICAgIHJldHVybiBTdG9yYWdlLmluaXQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pXG59KVxuIiwiYW5nQXBwLmNvbnRyb2xsZXIoJ0Rhc2hib2FyZEN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIFN0b3JhZ2UsIGluaXRpYWxpemUpe1xuICAvL2NvZGVcbiAgJHJvb3RTY29wZS4kb24oJ2RiTG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS5sb2coJ2luaXRpYWxpemVkJywgU3RvcmFnZS5maW5kT3JDcmVhdGUoJ1JpY2sgYW5kIE1vcnR5JykudGhlbihyZXN1bHQ9PiBjb25zb2xlLmxvZyhyZXN1bHQpKSk7XG4gICAgLy8gLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7Y29uc29sZS5sb2cocmVzdWx0KX0pO1xuICB9KVxuXG59KVxuIiwiYXBwLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlcikge1xuICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnZGFzaGJvYXJkU3RhdGUnLCB7XG4gICAgdXJsOiAnL3Rlc3QnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9hcHAvanMvZGFzaGJvYXJkL2Rhc2hib2FyZC5odG1sJ1xuICB9KVxufSlcbiIsImFuZ0FwcC5jb250cm9sbGVyKCdFeHBsb3JlckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCB2aWRDb25zdGFudHMpIHtcbiAgLy8gQ29kZSB0byBtYWtlIHRoZSAnZmlsZSBob2xkZXIgZGl2JyB0YWtlIGluXG4gIC8vIGZpbGUgcGF0aCBuYW1lc1xuICB2YXIgaG9tZWRpciA9IChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSA/IHByb2Nlc3MuZW52LkhPTUVQQVRIIDpcbiAgICBwcm9jZXNzLmVudi5IT01FO1xuICBjb25zdCBzaGVsbCA9IHJlcXVpcmUoJ2VsZWN0cm9uJykuc2hlbGw7XG4gIC8vIHZhciBmaW5kZXIgPSByZXF1aXJlKCcuL3NlcnZlci9hbGdvcml0aG1zL3NlYXJjaC5qcycpXG4gIHZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG4gIHZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuICB2YXIgZmluZCA9IHJlcXVpcmUoJ2ZpbmRpdCcpO1xuICB2YXIgcGFyc2VWaWRlbyA9IHJlcXVpcmUoJ3ZpZGVvLW5hbWUtcGFyc2VyJyk7XG5cbiAgLy9CdXR0b24gY2FsbGVkIFwiYnJvd3NlXCIsIG9wZW5zIGhvbWVkaXJlY3Rvcnkgb2YgdXNlclxuICAkc2NvcGUub3BlbkhvbWUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gc2hlbGwuc2hvd0l0ZW1JbkZvbGRlcihob21lZGlyKTtcbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIENvZGUgdGhhdCBhbGxvd3MgeW91IHRvIHJlY3Vyc2UgdGhyb3VnaCB0aGUgZGlyZWN0b3JpZXNcbiAgLy9wcm92aWRlZCBhbmQgcmV0dXJuIGZpbGUgbmFtZXMgdGhhdCBlbmQgd2l0aCBjZXJ0YWluIGV4dHNcblxuICB2YXIgaG9sZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVob2xkZXInKTtcbiAgaG9sZGVyLm9uZHJhZ292ZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNsYXNzTmFtZSA9ICdob3Zlcic7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICBob2xkZXIub25kcmFnbGVhdmUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNsYXNzTmFtZSA9ICcnO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbiAgaG9sZGVyLm9uZHJvcCA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgZGF0YVBhdGhBcnJheSA9IFtdO1xuICAgIHZhciBzb2xuID0gW107XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZS5kYXRhVHJhbnNmZXIuZmlsZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGRhdGFQYXRoQXJyYXkucHVzaChlLmRhdGFUcmFuc2Zlci5maWxlc1tpXS5wYXRoKTtcbiAgICB9XG4gICAgZGF0YVBhdGhBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBmaW5kZXIgPSBmaW5kKGRhdGEpO1xuICAgICAgZmluZGVyLm9uKCdmaWxlJywgZnVuY3Rpb24oZmlsZSwgc3RhdCkge1xuICAgICAgICBpZiAodmlkQ29uc3RhbnRzLnZpZEV4dGVuc2lvbnMuaW5kZXhPZihwYXRoLmV4dG5hbWUoZmlsZSkpICE9PVxuICAgICAgICAgIC0xKSB7XG4gICAgICAgICAgdmFyIHBhcnNlZCA9IHBhcnNlVmlkZW8oZmlsZSk7XG4gICAgICAgICAgc29sbi5wdXNoKHBhcnNlZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCJUaGFuayB5b3UgZm9yIHlvdXIgcGF0aWVuY2UhXCIpO1xuICAgICAgfSlcbiAgICAgIGZpbmRlci5vbignZW5kJywgZnVuY3Rpb24oZmlsZSwgc3RhdCkge1xuICAgICAgICAvLyBzb2xuLmZvckVhY2goKVxuICAgICAgICBjb25zb2xlLmxvZygnc29sbicsIHNvbG4pXG4gICAgICB9KVxuICAgIH0pXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xufSk7XG5cblxuYW5nQXBwLmZhY3RvcnkoJ3ZpZENvbnN0YW50cycsIGZ1bmN0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIHZpZEV4dGVuc2lvbnM6IFsnLm1rdicsICcuYXZpJywgJy5tb3YnLCAnLmdpZnYnLCAnLmZsdiddXG4gIH1cbn0pXG4iLCJhbmdBcHAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdleHBsb3JlclN0YXRlJywge1xuICAgIHVybDogJy8nLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9hcHAvanMvZXhwbG9yZXIvZXhwbG9yZXIuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ0V4cGxvcmVyQ3RybCdcbiAgfSlcbn0pXG4iLCIndXNlIHN0cmljdCc7XG52YXIgbG9raSA9IHJlcXVpcmUoJ2xva2lqcycpLFxuXHRwYXRoID0gcmVxdWlyZSgncGF0aCcpLFxuXHRQcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKSxcblx0b21kYiA9IFByb21pc2UucHJvbWlzaWZ5QWxsKHJlcXVpcmUoJ29tZGInKSk7XG5cblxuYW5nQXBwLmZhY3RvcnkoJ1N0b3JhZ2UnLCBmdW5jdGlvbigkcm9vdFNjb3BlKSB7XG4gIGZ1bmN0aW9uIGZpbmRPbWRiKG5hbWUpIHtcbiAgXHRjb25zb2xlLmxvZygnaW4gb21kYiBmdW5jdGlvbicsIG5hbWUpO1xuICBcdHJldHVybiBvbWRiLnNlYXJjaEFzeW5jKG5hbWUpXG4gIFx0XHQudGhlbihmdW5jdGlvbihyZXN1bHRzKSB7XG4gIFx0XHRcdGlmIChyZXN1bHRzLmxlbmd0aCA8IDEpIHJldHVybjtcbiAgXHRcdFx0aWYgKHJlc3VsdHMubGVuZ3RoID49IDEpIHtcbiAgXHRcdFx0XHRyZXR1cm4gb21kYi5nZXRBc3luYyhyZXN1bHRzWzBdLmltZGIpO1xuICBcdFx0XHR9XG4gIFx0XHR9KVxuICB9O1xuICBmdW5jdGlvbiBhZGRNZWRpYShtZWRpYVRpdGxlKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGNvbnNvbGUubG9nKHNlbGYpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGNvbnNvbGUubG9nKHNlbGYpO1xuICAgICAgZmluZE9tZGIobWVkaWFUaXRsZSlcbiAgICAgIC50aGVuKGZ1bmN0aW9uKG1ldGFkYXRhKSB7XG4gICAgICAgIHZhciBtZWRpYSA9IHt9O1xuICAgICAgICBtZWRpYSA9IG1ldGFkYXRhO1xuICAgICAgICBtZWRpYS5faWQgPSBtZXRhZGF0YS5pbWRiLmlkO1xuICAgICAgICBzZWxmLmNvbGxlY3Rpb24uaW5zZXJ0KG1lZGlhKTtcbiAgICAgICAgY29uc29sZS5sb2cobWVkaWEpO1xuICAgICAgICBzZWxmLmRiLnNhdmVEYXRhYmFzZSgpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHNlbGYpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0pO1xuICAgIH0pXG4gIH07XG5cblx0cmV0dXJuIHtcblx0XHRkYjogbmV3IGxva2kocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJ2FwcC5kYicpKSxcblx0XHRjb2xsZWN0aW9uOiBudWxsLFxuXHRcdGxvYWRlZDogZmFsc2UsXG5cdFx0aW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRzZWxmLmRiLmxvYWREYXRhYmFzZSh7fSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdFx0XHRcdGlmIChzZWxmLmRiLmNvbGxlY3Rpb25zLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLmNvbGxlY3Rpb24gPSBzZWxmLmRiLmdldENvbGxlY3Rpb24oJ21lZGlhJyk7XG5cdFx0XHRcdFx0XHRcdHNlbGYubG9hZGVkID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlc29sdmUoc2VsZik7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRzZWxmLmRiLmFkZENvbGxlY3Rpb24oJ21lZGlhJyk7XG5cdFx0XHRcdFx0XHRcdHNlbGYuZGIuc2F2ZURhdGFiYXNlKCk7XG5cdFx0XHRcdFx0XHRcdHNlbGYuY29sbGVjdGlvbiA9IHNlbGYuZGIuZ2V0Q29sbGVjdGlvbignbWVkaWEnKTtcblx0XHRcdFx0XHRcdFx0c2VsZi5sb2FkZWQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gcmVzb2x2ZShzZWxmKVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnaW4gdGhlIGZhY3RvcnknLCBzZWxmKTtcblx0XHRcdFx0XHRcdCRyb290U2NvcGUuJGVtaXQoJ2RiTG9hZGVkJyk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0XHQudGhlbihudWxsLCBmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGVycilcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdC8vIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHQvLyBcdGNvbnNvbGUubG9nKGVycik7XG5cdFx0XHRcdFx0Ly8gfSlcblx0XHRcdH0pXG5cdFx0fSxcblx0XHRmaW5kTWVkaWE6IGZ1bmN0aW9uKG1lZGlhSWQpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdFx0aWYgKHNlbGYubG9hZGVkICYmIHNlbGYuZGIuZ2V0Q29sbGVjdGlvbignbWVkaWEnKSkge1xuICAgICAgICAgIHJldHVybiByZXNvbHZlKHNlbGYuY29sbGVjdGlvbi5maW5kKHtcIl9pZFwiOiBtZWRpYUlkfSkpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJlamVjdChuZXcgRXJyb3IoJ2RiIGlzIG5vdCByZWFkeScpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9LFxuICAgIGFkZE1lZGlhOiBhZGRNZWRpYSxcbiAgICBmaW5kT3JDcmVhdGU6IGZ1bmN0aW9uKG1lZGlhVGl0bGUpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIGNvbnNvbGUubG9nKCdpbiB0aGUgZmluZE9yQ3JlYXRlJylcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgaWYgKHNlbGYubG9hZGVkICYmIHNlbGYuZGIuZ2V0Q29sbGVjdGlvbignbWVkaWEnKSkge1xuICAgICAgICAgIGZpbmRPbWRiKG1lZGlhVGl0bGUpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24obWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbGxlY3Rpb24uZmluZCh7J19pZCc6IG1ldGFkYXRhLmltZGIuaWR9KS5sZW5ndGg+MCkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmNvbGxlY3Rpb24uZmluZCh7J3RpdGxlJzogbWVkaWFUaXRsZX0pLmxlbmd0aCk7XG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKG51bGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0aW5nJyk7XG4gICAgICAgICAgICAgIHZhciBtZWRpYSA9IHt9O1xuICAgICAgICAgICAgICBtZWRpYSA9IG1ldGFkYXRhO1xuICAgICAgICAgICAgICBtZWRpYS5faWQgPSBtZXRhZGF0YS5pbWRiLmlkO1xuICAgICAgICAgICAgICBzZWxmLmNvbGxlY3Rpb24uaW5zZXJ0KG1lZGlhKTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2cobWVkaWEpO1xuICAgICAgICAgICAgICBzZWxmLmRiLnNhdmVEYXRhYmFzZSgpO1xuICAgICAgICAgICAgICByZXNvbHZlKHNlbGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignZGIgaXMgbm90IHJlYWR5JykpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cdH07XG59KTtcbiIsImFwcC5jb250cm9sbGVyKCdTaWRlYmFyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSkge1xuXG4gIC8vTGVmdG92ZXIgYXR0ZW1wdHMgdG8gbWFrZSBzaWRlYmFyIHRvZ2dsZWFibGVcbiAgLy8gJHNjb3BlLm1lbnVBY3RpdmUgPSBmYWxzZTtcbiAgLy8gdmFyIHdyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2lkZWJhci13cmFwcGVyJylcbiAgLy8gJHNjb3BlLnRvZ2dsZU1lbnUgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgLy8gd3JhcHBlci50b2dnbGVDbGFzcyhcInRvZ2dsZWRcIik7XG4gIC8vICAgJHNjb3BlLm1lbnVBY3RpdmUgPSAhJHNjb3BlLm1lbnVBY3RpdmU7XG4gIC8vfVxuXG4gIC8vcGxhY2Vob2xkZXIgZm9yIG1ha2luZyBuZXcgcGxheWxpc3RzXG5cblxufSlcbiIsImFwcC5kaXJlY3RpdmUoJ3NpZGViYXInLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9hcHAvanMvZGlyZWN0aXZlcy9zaWRlYmFyL3NpZGViYXIuaHRtbCdcbiAgfTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
